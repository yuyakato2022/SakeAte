<h3>レシピ詳細</h3>
<p><%= image_tag @recipe.get_image(200, 200) %></p>
<p>レシピ名：<%= @recipe.name %></p>
<p>お酒：</p>
<% @recipe.alcohols.each do |alcohol| %>
  <%= alcohol.name %>
<% end %>
<p><%= @recipe.ingredient%></p>
<p>食材：<%= @recipe.explanation %></p>
<p>作り方：<%= @recipe.procedure %></p>

<% if @recipe.bookmarked_by?(current_user) %>
    <%= link_to public_recipe_bookmarks_path(@recipe), method: :delete do %>
      <i class="fas fa-bookmark"></i>
    <% end %>
  <% else %>
    <%= link_to public_recipe_bookmarks_path(@recipe), method: :post do %>
      <i class="far fa-bookmark"></i>
    <% end %>
  <% end %>

<% @recipe.reviews.each do |review| %>
  <%= review.user.name %>
  <%= review.created_at.strftime('%Y/%m/%d') %><%= review.text %>
  <% if review.user == current_user %>
    <%= link_to "コメント削除", public_recipe_review_path(review.recipe, review), method: :delete %>
  <% end %>
  <script>
  $(document).on('turbolinks:load', function() {
    $('#rate_<%= review.id %>').empty();
    $('#rate_<%= review.id %>').raty({
      size: 20,
      starOff:  '<%= asset_path('star-off.png') %>',
      starOn : '<%= asset_path('star-on.png') %>',
      starHalf: '<%= asset_path('star-half.png') %>',
      half: true,
      readOnly: true,
      score: <%= @recipe.rate %>,
    });
  });
  </script>
<% end %>


<%= form_with model: [@recipe, @review], url: public_recipe_reviews_path(@recipe), method: :post do |f| %>
  <%= f.label :text %>
  <%= f.text_area :text, rows: '5', placeholder: "コメントをここに" %>
  <div class="form-group" id="star">
    <%= f.label :rate %>
    <%= f.hidden_field :rate, id: :review_star, class:'form-control' %>
  </div>

  <script>
  $(document).on('turbolinks:load', function() {
    $('#star').empty();
    $('#star').raty({
      size     : 36,
      starOff:  '<%= asset_path('star-off.png') %>',
      starOn : '<%= asset_path('star-on.png') %>',
      starHalf: '<%= asset_path('star-half.png') %>',
      scoreName: 'recipe[rate]',
      half: true,
    });
  })
  </script>
  <%= f.submit "送信する" %>
<% end %>